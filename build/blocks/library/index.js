!function(){"use strict";var e,t=window.wp.blocks,o=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"formello/library","title":"Form Library","description":"A block to display or create forms.","category":"formello","textdomain":"formello","attributes":{"ref":{"type":"number"}},"supports":{"html":false,"lock":false,"reusable":false,"inserter":true},"editorScript":"file:./index.js"}'),l=window.React,r=window.wp.data,a=window.wp.coreData,n=window.wp.components,s=window.wp.i18n,c=window.wp.blockEditor,i=window.wp.element;function m({selectedCategory:e,patternCategories:t,onClickCategory:o}){const r="block-editor-block-patterns-explorer__sidebar";return(0,l.createElement)("div",{className:`${r}__categories-list`},[...new Set(t)].map((t=>(0,l.createElement)(n.Button,{key:t.slug,label:t.name,className:`${r}__categories-list__item`,isPressed:e===t.slug,onClick:()=>{o(t.slug)}},t.name))))}function p({searchValue:e,setSearchValue:t}){return(0,l.createElement)("div",{className:"block-editor-block-patterns-explorer__search"},(0,l.createElement)(n.SearchControl,{__nextHasNoMarginBottom:!0,onChange:t,value:e,label:(0,s.__)("Search for patterns"),placeholder:(0,s.__)("Search")}))}function u({selectedCategory:e,patternCategories:t,onClickCategory:o,searchValue:r,setSearchValue:a}){return(0,l.createElement)("div",{className:"block-editor-block-patterns-explorer__sidebar"},(0,l.createElement)(p,{searchValue:r,setSearchValue:a}),!r&&(0,l.createElement)(m,{selectedCategory:e,patternCategories:t,onClickCategory:o}))}function d({clientId:e,blockName:t,onRequestClose:o}){const{replaceBlock:a}=(0,r.useDispatch)(c.store),[m,p]=(0,i.useState)(),[d,_]=(0,i.useState)("all"),f=(0,r.useSelect)((o=>{const{getBlockRootClientId:l,getPatternsByBlockTypes:r}=o(c.store),a=l(e);return r(t,a)}),[e,t]),b=f.filter((e=>m?e.title.toLowerCase().includes(m):"all"===d||e.categories.includes(d))),g=[{slug:"all",name:(0,s.__)("All","popper")},{slug:"promo",name:(0,s.__)("Promo","popper")},{slug:"top-bar",name:(0,s.__)("Top bar","popper")},{slug:"ad-block",name:(0,s.__)("Ad Block","popper")}];return f.map((e=>e.categories)).join(",").split(","),(0,l.createElement)(n.Modal,{className:"block-editor-query-pattern__selection-modal",isFullScreen:!0,title:(0,s.__)("Choose a form","formello"),closeLabel:(0,s.__)("Cancel"),onRequestClose:o},(0,l.createElement)("div",{className:"block-editor-block-patterns-explorer"},(0,l.createElement)(u,{selectedCategory:d,patternCategories:g,onClickCategory:_,searchValue:m,setSearchValue:p}),(0,l.createElement)("div",{className:"block-editor-block-patterns-explorer__list"},(0,l.createElement)(c.BlockContextProvider,{value:{postType:"formello_form"}},(0,l.createElement)(c.__experimentalBlockPatternsList,{blockPatterns:b,shownPatterns:b,onClickPattern:t=>{a(e,t.blocks)}})))))}function _(){return _=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e},_.apply(this,arguments)}(0,t.registerBlockType)(o,{icon:function(t){return l.createElement("svg",_({xmlns:"http://www.w3.org/2000/svg",width:341.333,height:341.333,viewBox:"0 0 256 256"},t),e||(e=l.createElement("path",{fill:"#9b51e0",d:"M0 128v128h256V0H0v128zm145.6-66.6c2.9.7 7.8 2.8 11.1 4.5 6.7 3.6 18.3 14.6 16.8 16-2.6 2.3-31.9 23.1-32.6 23.1-.5 0-.9-.5-.9-1 0-.6-1.1-2.2-2.5-3.5-3-3.1-8.3-3.3-11.6-.6-2.2 1.8-2.4 2.7-2.7 14l-.4 12.1H136v37h-13v34H82v-44.8c0-35.5.3-46.1 1.5-51.7 3.9-18.6 18.2-34.2 35.6-38.9 6.9-1.9 19.9-2 26.5-.2z"})))},edit:function({attributes:{ref:e},clientId:t,name:o,setAttributes:m}){const[p,u]=(0,i.useState)(!1),[_,f]=(0,i.useState)(!0),[b,g]=(0,i.useState)(""),{innerBlocks:k,userCanEdit:E,getBlockEditingMode:h,onNavigateToEntityRecord:v,editingMode:C,hasPatternOverridesSource:y}=(0,r.useSelect)((o=>{const{canUser:l}=o(a.store),{getBlocks:r,getSettings:n,getBlockEditingMode:s}=o(c.store);return{innerBlocks:r(t),userCanEdit:l("update","blocks",e),getBlockEditingMode:s,onNavigateToEntityRecord:n().onNavigateToEntityRecord,editingMode:s(t)}}),[t,e]),w=(0,c.useHasRecursion)(e),{record:B,hasResolved:S}=(0,a.useEntityRecord)("postType","formello_form",e),x=S&&!B,N=(0,r.useSelect)((e=>{const t=e("core").getEntityRecords("postType","formello_form",{per_page:-1}),o=[{value:"",label:(0,s.__)("Select a form","formello")}];return t?.forEach((e=>{o.push({value:e.id,label:e.title.raw||(0,s.__)("No title","formello")})})),o}),[]),{saveEntityRecord:P}=(0,r.useDispatch)(a.store),I=(0,i.useCallback)((async(e=null)=>P("postType","formello_form",{title:e,content:'\x3c!-- wp:formello/form {"lock":{"move":false,"remove":true}} --\x3e\n\t\t\t\t<form class="wp-block-formello-form" method="post" data-id="11" data-validate="true" novalidate action=""><input type="hidden" name="_formello_id" value="11"/><input type="text" name="_formello_h11" class="formello-hp" aria-label="If you are human, leave this field blank." tabindex="-1"/><input type="hidden" name="action" value="formello"/><div class="formello-message" id="formello-message-11"></div></form>\n\t\t\t\t\x3c!-- /wp:formello/form --\x3e',status:"publish",excerpt:""}).then((e=>{m({ref:e.id}),f(!1)}))),[P,m]),[R,T,V]=(0,a.useEntityBlockEditor)("postType","formello_form",{id:e}),M=(0,c.useBlockProps)({className:"block-library-block__reusable-block-container"}),O=(0,c.useInnerBlocksProps)(M,{value:R,onInput:T,onChange:V,allowedBlocks:["formello/form"],renderAppender:R?.length?void 0:c.InnerBlocks.ButtonBlockAppender});return w?(0,l.createElement)("div",{...M},(0,l.createElement)(c.Warning,null,(0,s.__)("Block cannot be rendered inside itself."))):!e||x?(0,l.createElement)("div",{...M},(0,l.createElement)(c.InspectorControls,null,(0,l.createElement)(n.PanelBody,{title:(0,s.__)("Form Settings","formello"),initialOpen:!0},(0,l.createElement)(n.SelectControl,{label:(0,s.__)("Choose a form","formello"),options:N,onChange:e=>{m({ref:parseInt(e)})}}))),(0,l.createElement)(n.Placeholder,{instructions:(0,s.__)("Insert from library or create a new form.","formello"),label:(0,s.__)("Insert a form","formello")},"widgets"===window.pagenow?(0,l.createElement)(n.SelectControl,{label:(0,s.__)("Choose a form","formello"),value:e,options:N,onChange:e=>{m({ref:parseInt(e)})}}):(0,l.createElement)(i.Fragment,null,(0,l.createElement)(n.Button,{isPrimary:!0,icon:"book",onClick:()=>{u("templates")}},(0,s.__)("Open Library","formello")),(0,l.createElement)(n.Button,{variant:"secondary",onClick:()=>{u("create")}},(0,s.__)("Create a new form","formello")))),"create"===p&&(0,l.createElement)(n.Modal,{title:(0,s.__)("Create Reusable form"),onRequestClose:()=>{u(!1),g("")},overlayClassName:"reusable-blocks-menu-items__convert-modal"},(0,l.createElement)("form",{onSubmit:e=>{e.preventDefault(),I(b),u(!1),g("")}},(0,l.createElement)(n.__experimentalVStack,{spacing:"5"},(0,l.createElement)(n.TextControl,{__nextHasNoMarginBottom:!0,label:(0,s.__)("Name"),value:b,onChange:g}),(0,l.createElement)(n.__experimentalHStack,{justify:"right"},(0,l.createElement)(n.Button,{variant:"tertiary",onClick:()=>{u(!1),g("")}},(0,s.__)("Cancel")),(0,l.createElement)(n.Button,{variant:"primary",type:"submit"},(0,s.__)("Save")))))),"templates"===p&&(0,l.createElement)(d,{clientId:t,onRequestClose:()=>u(!1),blockName:o})):x?(0,l.createElement)("div",{...M},(0,l.createElement)(c.Warning,{actions:[(0,l.createElement)(n.Button,{variant:"primary",onClick:()=>m({ref:""}),key:"create-new"},(0,s.__)("Create a new form"))]},(0,s.__)("Block has been deleted or is unavailable."))):S?(0,l.createElement)(c.RecursionProvider,{uniqueId:e},(0,l.createElement)(c.BlockControls,null,(0,l.createElement)(n.ToolbarGroup,null,(0,l.createElement)(n.ToolbarButton,{onClick:()=>{v({postId:e,postType:"formello_form"})}},(0,s.__)("Edit original")))),(0,l.createElement)(c.InspectorControls,null,(0,l.createElement)(n.PanelBody,{title:(0,s.__)("Form Settings","formello"),initialOpen:!0},(0,l.createElement)(n.SelectControl,{label:(0,s.__)("Choose a form","formello"),value:e,options:N,onChange:e=>{m({ref:parseInt(e)})}}))),(0,l.createElement)("div",{...M},(0,l.createElement)(n.Disabled,{isDisabled:_},(0,l.createElement)("div",{...O})))):(0,l.createElement)("div",{...M},(0,l.createElement)(n.Placeholder,null,(0,l.createElement)(n.Spinner,null)))}})}();