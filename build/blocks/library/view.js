import*as e from"@wordpress/interactivity";var t={d:(e,o)=>{for(var s in o)t.o(o,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:o[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const o=(l={getConfig:()=>e.getConfig,getContext:()=>e.getContext,getElement:()=>e.getElement,store:()=>e.store},r={},t.d(r,l),r),s={bouncer:{disableSubmit:!0,customValidations:{valueMismatch(e){const t=e.getAttribute("data-bouncer-match");if(!t)return!1;const o=e.form.querySelector("[name="+t+"]");return!!o&&o.value!==e.value}},messageCustom:"data-bouncer-message",messages:{valueMismatch:e=>e.getAttribute("data-bouncer-mismatch-message")||"Please make sure the fields match."}},tinyMce:{selector:"textarea.formello-advanced",setup:e=>{e.on("change",(()=>{window.tinymce.triggerSave()}))},menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"formatselect | bold italic underline | bullist numlist  | alignleft aligncenter alignright alignjustify | link unlink | undo redo",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"}},n=(e,t)=>{const o=e.submitter||e.target.closest("button");o.classList.toggle("wp-block-formello-button--loading",t),o.toggleAttribute("disabled",t)},{state:a}=(0,o.store)("formello",{state:{get debugData(){const e=(0,o.getContext)();return JSON.stringify(e.response.data.debug,void 0,2)},get message(){const e=(0,o.getContext)();return e.response?.data?.message||""},get errors(){const e=(0,o.getContext)();return e.response?.data?.errors||[]}},actions:{validateCaptcha:e=>{const{ref:t}=(0,o.getElement)();if(e.preventDefault(),!t.closest("form").checkValidity())return t.closest("form").requestSubmit(t),!1;n(e),(async()=>{const e=(0,o.getConfig)(),t=(0,o.getContext)();if(t.captchaEnabled&&"reCaptcha"===t.captchaType&&"invisible"===e.settings.reCaptcha.version)return window.grecaptcha.execute();t.captchaEnabled&&"hCaptcha"===t.captchaType&&await window.hcaptcha.execute({async:!0})})().then((()=>{t.closest("form").requestSubmit(t)}))},sendForm:e=>{e.preventDefault(),e.stopPropagation();const{ref:t}=(0,o.getElement)();if((0,o.getContext)().enableJsValidation&&!t.checkValidity()){const e=t.querySelector("input:invalid, select:invalid");return e?.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),void e?.focus()}(async e=>{const{ref:t}=(0,o.getElement)(),s=(0,o.getContext)(),a=(0,o.getConfig)(),{id:l}=t.dataset,r=new FormData(t);r.append("action","formello"),r.append("_formello",a.nonce),r.append("_formello_id",l);try{n(e,!0);const o=await fetch(a.ajax_url,{method:"POST",body:r}),l=await o.json();s.response=l,n(e,!1),((e,t)=>{const{data:o}=t;if(o.redirect_url&&t.success)return window.location=o.redirect_url,!1;if(o.hide&&t.success){const t=e.querySelector(".formello-message");e.insertAdjacentElement("beforebegin",t),setTimeout((()=>{e.style.display="none",t.scrollIntoView({behavior:"smooth"})}),"300")}o.debug&&t.success&&console.log(o.debug),t.success&&e.reset()})(t,l)}catch(t){n(e,!1),s.response="string"==typeof t||t instanceof String?{data:{message:t},success:!1}:{data:{message:"An error occurred"},success:!1}}})(e)},setOutput:()=>{const{ref:e}=(0,o.getElement)();"OUTPUT"===e.nextElementSibling?.nodeName&&(e.nextElementSibling.value=e.value)},validateInput:()=>{(0,o.getContext)().enableJsValidation&&(()=>{const{ref:e}=(0,o.getElement)(),t=(0,o.getContext)();e.validity.valid||console.log(e.validity,e);let s=e.parentNode.querySelector(".error-message");if(!s){const t=e.closest(".wp-block-formello-multichoices").querySelector("input[type=checkbox]:checked"),o=e.closest(".wp-block-formello-multichoices").querySelectorAll("input[type=checkbox]:not(:checked)");t?o.forEach((e=>{e.required=!1})):e.closest(".wp-block-formello-multichoices").querySelectorAll("input[type=checkbox]").forEach((e=>{e.required=!0})),s=e.closest(".wp-block-formello-multichoices").querySelector(".error-message")}(e.validity.typeMismatch||e.validity.badInput)&&(s.innerHTML=t.messages.patternMismatch[e.type]),e.validity.valueMissing&&(s.innerHTML=t.messages.missingValue.hasOwnProperty(e.type)?t.messages.missingValue[e.type]:t.messages.missingValue.default)})()}},callbacks:{init:()=>{const e=(0,o.getContext)(),t=(0,o.getConfig)();e.messages={...s.bouncer.messages,...t.settings.messages},window.tinymce?.init(s.tinyMce),window.flatpickr?.("input.formello-advanced[type=date]"),document.querySelectorAll(".wp-block-formello-input, .wp-block-formello-select, .wp-block-formello-textarea, .wp-block-formello-multichoices").forEach((e=>{if(e.parentNode.classList.contains("wp-block-formello-multichoices"))return;const t=document.createElement("div");t.classList.add("error-message"),e.appendChild(t)})),document.querySelectorAll('input[type="tel"].formello-advanced').forEach((e=>{window.intlTelInput?.(e,{loadUtilsOnInit:"https://cdn.jsdelivr.net/npm/intl-tel-input@24.6.0/build/js/utils.js",hiddenInput:e=>({phone:e+"_full",country:e+"_country_code"})})})),document.querySelectorAll("select.formello-advanced").forEach((e=>{new window.TomSelect(e,{create:!0,sortField:{field:"text",direction:"asc"}})}))}}});var l,r;